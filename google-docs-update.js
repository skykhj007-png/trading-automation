/**
 * V39 MTF Confluence Pro - Google Docs ì—…ë°ì´íŠ¸ ìŠ¤í¬ë¦½íŠ¸
 *
 * ì‚¬ìš©ë²•:
 * 1. Google Apps Script (script.google.com) ì—ì„œ ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
 * 2. ì´ ì½”ë“œë¥¼ ë¶™ì—¬ë„£ê¸°
 * 3. DOC_IDë¥¼ ì‹¤ì œ ë¬¸ì„œ IDë¡œ ë³€ê²½
 * 4. updateV39Documentation() í•¨ìˆ˜ ì‹¤í–‰
 */

// êµ¬ê¸€ ë¬¸ì„œ ID (URLì—ì„œ /d/ ì™€ /edit ì‚¬ì´ì˜ ë¬¸ìì—´)
const DOC_ID = "YOUR_GOOGLE_DOC_ID_HERE";

function updateV39Documentation() {
  const doc = DocumentApp.openById(DOC_ID);
  const body = doc.getBody();

  // ê¸°ì¡´ ë‚´ìš© ì‚­ì œ
  body.clear();

  // ì œëª©
  const title = body.appendParagraph("V39 MTF Confluence Pro ì‚¬ìš©ì„¤ëª…ì„œ");
  title.setHeading(DocumentApp.ParagraphHeading.HEADING1);
  title.setAlignment(DocumentApp.HorizontalAlignment.CENTER);

  // ì¤‘ìš” ì•ˆë‚´
  addSection(body, "ì¤‘ìš” ì•ˆë‚´", [
    "ë³¸ ì§€í‘œëŠ” êµìœ¡ ë° ì°¸ê³  ëª©ì ìœ¼ë¡œë§Œ ì œê³µë©ë‹ˆë‹¤.",
    "ì‹œê·¸ë„ì€ íˆ¬ì ê¶Œìœ ê°€ ì•„ë‹™ë‹ˆë‹¤",
    "ëª¨ë“  íˆ¬ì ê²°ì •ê³¼ ì†ì‹¤ ì±…ì„ì€ ë³¸ì¸ì—ê²Œ ìˆìŠµë‹ˆë‹¤",
    "ì‹œê·¸ë„ì´ 100% ìˆ˜ìµì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"
  ]);

  // V39 ì‹ ê·œ ê¸°ëŠ¥
  addSection(body, "V39 ì‹ ê·œ ê¸°ëŠ¥ (BOS/EMA êµ¬ì¡° ë¶„ì„)", [
    "",
    "ğŸ“Š ì‹œì¥ êµ¬ì¡° ë¼ë²¨",
    "â€¢ HH (ì´ˆë¡) = Higher High - ê³ ì  ê°±ì‹ ",
    "â€¢ HL (ì´ˆë¡) = Higher Low - ì €ì  ìƒìŠ¹",
    "â€¢ LH (ë¹¨ê°•) = Lower High - ê³ ì  í•˜ë½",
    "â€¢ LL (ë¹¨ê°•) = Lower Low - ì €ì  ì´íƒˆ",
    "",
    "ğŸ”„ BOS (Break of Structure)",
    "â€¢ BOS+ = ìƒìŠ¹ êµ¬ì¡° ëŒíŒŒ (ì²­ë¡ìƒ‰ ë°•ìŠ¤)",
    "â€¢ BOS- = í•˜ë½ êµ¬ì¡° ëŒíŒŒ (ë¶„í™ìƒ‰ ë°•ìŠ¤)",
    "",
    "ğŸ”„ CHoCH (Change of Character)",
    "â€¢ CHoCH+ = í•˜ë½â†’ìƒìŠ¹ ì¶”ì„¸ ì „í™˜ (ë¼ì„ìƒ‰ ë¼ë²¨)",
    "â€¢ CHoCH- = ìƒìŠ¹â†’í•˜ë½ ì¶”ì„¸ ì „í™˜ (ë¶„í™ìƒ‰ ë¼ë²¨)",
    "",
    "ğŸ“ˆ EMA ê°ë„ ìƒ‰ìƒ",
    "â€¢ ğŸŸ¢ ì´ˆë¡ = ê°•í•œ ìƒìŠ¹ (ê°ë„ > ì„ê³„ê°’)",
    "â€¢ ğŸŸ¡ ë…¸ë‘ = ì•½í•œ ìƒìŠ¹ (0 < ê°ë„ < ì„ê³„ê°’)",
    "â€¢ ğŸŸ  ì£¼í™© = íš¡ë³´ (ê°ë„ â‰ˆ 0)",
    "â€¢ ğŸ”´ ë¹¨ê°• = í•˜ë½ (ê°ë„ < 0)"
  ]);

  // í•„ìˆ˜ ì§„ì… ì¡°ê±´
  addSection(body, "ìŠ¹ë¥  ë†’ì€ ì§„ì… ì¡°ê±´", [
    "",
    "âœ… ë°˜ë“œì‹œ í™•ì¸í•´ì•¼ í•  5ê°€ì§€",
    "",
    "1. 1H/4H ì¶”ì„¸ UP (í•„ìˆ˜)",
    "   - í…Œì´ë¸”ì—ì„œ 1H, 4H ëª¨ë‘ \"UP\" í™•ì¸",
    "",
    "2. ìœ„ì¹˜ 20% ì´í•˜ (í•„ìˆ˜)",
    "   - ì§€ì§€ì„  ê·¼ì²˜ (í…Œì´ë¸” \"ìœ„ì¹˜\" í™•ì¸)",
    "",
    "3. Smart Trail ë¼ì„ìƒ‰ (í•„ìˆ˜)",
    "   - ì°¨íŠ¸ì˜ ì¶”ì„¸ì„ ì´ ë¼ì„(ì—°ë‘)ìƒ‰",
    "",
    "4. ê±°ë˜ëŸ‰ 2ê°œ TF ì´ìƒ ê¸‰ì¦ (ê¶Œì¥)",
    "   - í…Œì´ë¸” Vol ì—´ì—ì„œ 1.5x ì´ìƒ 2ê°œ+",
    "",
    "5. ë“±ê¸‰ B+ ì´ìƒ (16ì +) (ê¶Œì¥)",
    "   - í…Œì´ë¸” ìš°ì¸¡ ë“±ê¸‰ í‘œì‹œ í™•ì¸"
  ]);

  // ì§„ì… ê¸ˆì§€
  addSection(body, "ì§„ì…í•˜ë©´ ì•ˆ ë˜ëŠ” ìƒí™©", [
    "",
    "ğŸš« 1H ë˜ëŠ” 4Hê°€ DOWN â†’ ì†ì ˆ í™•ë¥  ë†’ìŒ",
    "ğŸš« ìœ„ì¹˜ 50% ì´ìƒ â†’ ë˜ëŒë¦¼ ìœ„í—˜",
    "ğŸš« Smart Trail ë¹¨ê°„ìƒ‰ â†’ ì—­ì¶”ì„¸ ë§¤ë§¤ ìœ„í—˜",
    "ğŸš« ê±°ë˜ëŸ‰ ì—†ìŒ â†’ ì›€ì§ì„ ì—†ìŒ",
    "ğŸš« ë“±ê¸‰ C (15ì  ë¯¸ë§Œ) â†’ ë¶ˆí™•ì‹¤í•œ ì§„ì…"
  ]);

  // ì‹œê·¸ë„ ì¢…ë¥˜
  addSection(body, "ì‹œê·¸ë„ ì¢…ë¥˜", [
    "",
    "ğŸ’ SUPER LONG (í•˜ëŠ˜ìƒ‰ ë‹¤ì´ì•„ëª¬ë“œ) - ìµœê³  ì‹ ë¢°ë„",
    "â­ STRONG LONG (ë…¸ë€ í° ì‚¼ê°í˜•) - ë†’ì€ ì‹ ë¢°ë„",
    "ğŸŸ¢ LONG (ì´ˆë¡ ì‚¼ê°í˜•) - ì¤‘ê°„ ì‹ ë¢°ë„",
    "âŒ EXIT LONG (ë¹¨ê°„ X) - ì¦‰ì‹œ ì²­ì‚°",
    "ğŸŸ  Trail Warning (ì£¼í™© ì›) - ì£¼ì˜",
    "",
    "ê¶Œì¥: STRONG ì´ìƒ ì‹œê·¸ë„ë§Œ ê±°ë˜í•˜ì„¸ìš”"
  ]);

  // ì²­ì‚° íƒ€ì´ë°
  addSection(body, "ì²­ì‚° íƒ€ì´ë°", [
    "",
    "âš¡ ì¦‰ì‹œ ì²­ì‚°",
    "â€¢ EXIT LONG (ë¹¨ê°„ X) ë°œìƒ ì‹œ",
    "â€¢ Smart Trail ë¹¨ê°„ìƒ‰ ì „í™˜ ì‹œ",
    "â€¢ ì ìˆ˜ 15ì  ë¯¸ë§Œ í•˜ë½ ì‹œ",
    "",
    "âš ï¸ ì£¼ì˜ (ë¶€ë¶„ ì²­ì‚° ê³ ë ¤)",
    "â€¢ Trail Warning (ì£¼í™© ì›) ë°œìƒ ì‹œ",
    "â€¢ 1H ì¶”ì„¸ DOWN ì „í™˜ ì‹œ",
    "",
    "ğŸ’¡ EXIT = ì¦‰ì‹œ ì²­ì‚°! \"ì¡°ê¸ˆ ë”\"ëŠ” í° ì†ì‹¤ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤"
  ]);

  // ë“±ê¸‰ ì‹œìŠ¤í…œ
  addSection(body, "ë“±ê¸‰ ì‹œìŠ¤í…œ", [
    "",
    "ğŸ† Së“±ê¸‰ (22ì +) - ìµœê³ , ì ê·¹ ì§„ì…",
    "â­ A+ë“±ê¸‰ (22ì +) - ë§¤ìš° ê°•ë ¥",
    "ğŸ…°ï¸ Aë“±ê¸‰ (19ì +) - ê°•ë ¥",
    "âœ… B+ë“±ê¸‰ (16ì +) - ì¢‹ìŒ, ì§„ì… ê¶Œì¥",
    "ğŸ”µ Bë“±ê¸‰ (15ì +) - ì§„ì… ê°€ëŠ¥",
    "âšª Cë“±ê¸‰ (15ì  ë¯¸ë§Œ) - ëŒ€ê¸°",
    "",
    "ê¶Œì¥: B+ ì´ìƒë§Œ ê±°ë˜"
  ]);

  // ë¯¸ë‹ˆ íŒ¨ë„
  addSection(body, "ë¯¸ë‹ˆ íŒ¨ë„ (ìµœì†Œí™” ëª¨ë“œ)", [
    "",
    "ë°©í–¥ í‘œì‹œ (ë§¨ ìœ„ í–‰)",
    "â€¢ â–² LONG (ë¼ì„) = ë¡± ìœ ë¦¬",
    "â€¢ â–¼ SHORT (ë¹¨ê°•) = ìˆ ìœ ë¦¬",
    "â€¢ â€” WAIT (íšŒìƒ‰) = ëŒ€ê¸°",
    "",
    "EMA ê°ë„ ìƒíƒœ",
    "â€¢ â–²â–² = ê°•í•œ ìƒìŠ¹",
    "â€¢ â–² = ì•½í•œ ìƒìŠ¹",
    "â€¢ â€” = íš¡ë³´",
    "â€¢ â–¼ = í•˜ë½"
  ]);

  // ì•Œë¦¼ ì„¤ì •
  addSection(body, "ì•Œë¦¼ ì„¤ì • ë°©ë²•", [
    "",
    "1. ì°¨íŠ¸ì—ì„œ ì•Œë¦¼ ì•„ì´ì½˜ (ì¢… ëª¨ì–‘) í´ë¦­ ë˜ëŠ” Alt+A",
    "",
    "2. ì¡°ê±´ ì„¤ì •:",
    "   â€¢ ì²« ë²ˆì§¸: V39 MTF Confluence Pro ì„ íƒ",
    "   â€¢ ë‘ ë²ˆì§¸: \"ëª¨ë“  alert() í•¨ìˆ˜ í˜¸ì¶œ\" ì„ íƒ",
    "",
    "âš ï¸ ì¤‘ìš”: \"ëŒíŒŒ\", \"ë³´ë‹¤í¼\" ë“±ì€ ì„ íƒí•˜ì§€ ë§ˆì„¸ìš”!",
    "ë°˜ë“œì‹œ \"ëª¨ë“  alert() í•¨ìˆ˜ í˜¸ì¶œ\" ì„ íƒ!",
    "",
    "3. ë§Œë£Œ: ë¬´ê¸°í•œ (Open-ended) ê¶Œì¥",
    "",
    "ê¶Œì¥ íƒ€ì„í”„ë ˆì„:",
    "â€¢ ë°ì´íŠ¸ë ˆì´ë”©: 15ë¶„ë´‰",
    "â€¢ ìŠ¤ìœ™: 1ì‹œê°„ë´‰"
  ]);

  // ê¶Œì¥ ì„¤ì •
  addSection(body, "ê¶Œì¥ ì„¤ì •", [
    "",
    "â€¢ íƒ€ì„í”„ë ˆì„: 15ë¶„ / 1ì‹œê°„",
    "â€¢ ê±°ë˜ ëª¨ë“œ: í˜„ë¬¼",
    "â€¢ ì‹œê·¸ë„ í‘œì‹œ: STRONG ì´ìƒ",
    "â€¢ í™”ë©´ ëª¨ë“œ: ìµœì†Œí™”",
    "â€¢ ê±°ë˜ëŸ‰ ê¸‰ì¦ ë°°ìˆ˜: 1.5x",
    "â€¢ ê±°ë˜ëŸ‰ í­ì¦ ë°°ìˆ˜: 2.5x"
  ]);

  // ë©´ì±… ì¡°í•­
  addSection(body, "ë©´ì±… ì¡°í•­", [
    "",
    "â€¢ ë³¸ ì§€í‘œëŠ” êµìœ¡ ë° ì°¸ê³  ëª©ì ìœ¼ë¡œë§Œ ì œê³µë©ë‹ˆë‹¤",
    "â€¢ ì‹œê·¸ë„ = 100% ìˆ˜ìµ ë³´ì¥ ì•„ë‹˜",
    "â€¢ ëª¨ë“  íˆ¬ì ê²°ì •ê³¼ ì†ì‹¤ ì±…ì„ì€ ë³¸ì¸ì—ê²Œ ìˆìŠµë‹ˆë‹¤",
    "â€¢ ê³¼ê±° ì„±ê³¼ê°€ ë¯¸ë˜ ìˆ˜ìµì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤",
    "â€¢ ë°˜ë“œì‹œ ë³¸ì¸ì´ ê°ë‹¹ ê°€ëŠ¥í•œ ê¸ˆì•¡ìœ¼ë¡œë§Œ ê±°ë˜í•˜ì„¸ìš”"
  ]);

  // ë¬¸ì˜
  addSection(body, "ë¬¸ì˜", [
    "",
    "â€¢ í…”ë ˆê·¸ë¨: @pointting",
    "â€¢ ë¬´ë£Œ ì‹œê·¸ë„: @V39_Signal",
    "â€¢ ë´‡: @V30_Signal_bot"
  ]);

  // ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸
  const footer = body.appendParagraph("\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nV39 MTF Confluence Pro - " + new Date().toLocaleDateString('ko-KR') + " ì—…ë°ì´íŠ¸\në³¸ ì§€í‘œëŠ” ì°¸ê³ ìš©ì´ë©° íˆ¬ì ê¶Œìœ ê°€ ì•„ë‹™ë‹ˆë‹¤");
  footer.setAlignment(DocumentApp.HorizontalAlignment.CENTER);

  Logger.log("V39 ë¬¸ì„œ ì—…ë°ì´íŠ¸ ì™„ë£Œ!");
  return "ë¬¸ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.";
}

function addSection(body, title, contents) {
  const heading = body.appendParagraph(title);
  heading.setHeading(DocumentApp.ParagraphHeading.HEADING2);

  contents.forEach(line => {
    body.appendParagraph(line);
  });

  body.appendParagraph(""); // ë¹ˆ ì¤„
}

// ë©”ë‰´ ì¶”ê°€ (ë¬¸ì„œì—ì„œ ì‹¤í–‰í•˜ê¸° ì‰½ê²Œ)
function onOpen() {
  DocumentApp.getUi()
    .createMenu('V39 ë„êµ¬')
    .addItem('ë¬¸ì„œ ì—…ë°ì´íŠ¸', 'updateV39Documentation')
    .addToUi();
}
