# 매매지표 개발 기록 (V31 ~ V35)

## 날짜: 2024-12-31

---

## 버전 히스토리

### V31-Light (로딩 속도 최적화)
- **목적**: TradingView 로딩 속도 개선
- **변경**: request.security() 28개 → 10개 (튜플 최적화)
- **결과**: 로딩 속도 약 3배 향상

### V32-Scalping (스캘핑 최적화)
- **목적**: 1분봉/15분봉 스캘핑용
- **변경**: 신호 조건 완화, 타임프레임 자동 감지
- **결과**: 승률 20%, 거래 5,812회 → 실패

### V33-WinRate (승률 개선)
- **목적**: 승률 50%+ 달성
- **변경**:
  - TP:SL = 1.5:1
  - 최소 점수 상향 (15~17)
  - HTF 확인 강화
  - SHORT 기본 OFF
- **결과**: 승률 35%, 거래 192회, 손익비 0.21 → 개선 필요

### V34-ProfitRatio (손익비 개선)
- **목적**: 손익비 2:1 이상
- **변경**:
  - TP 확대, SL 축소
  - 트레일링 스탑 추가
  - 추세 초기 진입
- **결과**: 승률 13%, 손익비 0.16 → 더 나빠짐 (실패)

### V35-Signal (시그널 전용)
- **목적**: 수동 매매용 시그널 확인
- **타입**: indicator (strategy 아님)
- **기능**:
  - 거래량 급증 표시
  - 볼린저밴드 터치 표시
  - EMA 크로스 표시
  - MTF 시그널 일치 (현재TF + HTF)
  - 정보 테이블 (우측 상단)

### V35-Strategy (백테스트용)
- **목적**: MTF 시그널 백테스트
- **타입**: strategy
- **옵션**:
  - MTF 시그널만 거래: ON
  - LONG만 거래: ON (SHORT 비활성화)
  - TP: 1.0%, SL: 0.5% (2:1)
- **결과**: LONG 승률 31%, SHORT 승률 15%

---

## 핵심 발견사항

### 1. 스캘핑(1분봉) 문제점
- 노이즈가 너무 많음
- 타이트한 SL이 자주 트리거됨
- 자동매매보다 수동 판단이 유리

### 2. SHORT 성과
- 모든 버전에서 SHORT 승률이 낮음
- LONG만 거래하는 것이 효율적

### 3. MTF (Multi-TimeFrame) 효과
- 현재TF + HTF 동시 시그널 시 승률 상승
- HTF 추세 확인이 중요

### 4. 손익비 vs 승률
- 타이트한 SL → 승률 하락
- 넓은 TP → 도달 전 청산
- 균형점 찾기 어려움

---

## 파일 목록

| 파일명 | 타입 | 용도 |
|--------|------|------|
| 매매지표-V31-Light.pine | strategy | 로딩 최적화 |
| 매매지표-V32-Scalping.pine | strategy | 스캘핑 (비추천) |
| 매매지표-V33-WinRate.pine | strategy | 승률 개선 시도 |
| 매매지표-V34-ProfitRatio.pine | strategy | 손익비 개선 시도 |
| 매매지표-V35-Signal.pine | indicator | **실시간 시그널 (추천)** |
| 매매지표-V35-Strategy.pine | strategy | **백테스트용 (추천)** |

---

## V35 시그널 표시 설명

### 차트 기호
| 기호 | 색상 | 의미 |
|------|------|------|
| ▲ 큰 | 라임 | MTF LONG (강력) |
| ▲ 보통 | 초록 | LONG |
| ▼ 큰 | 핑크 | MTF SHORT (강력) |
| ▼ 보통 | 빨강 | SHORT |
| ◇ | 청록 | BB 하단 반등 |
| ○ | 라임 | 거래량 폭증 + 매수 |
| ✕ | 초록/빨강 | EMA 크로스 |

### 배경색
- 연두: 거래량 폭증 + 매수압력
- 연분홍: 거래량 폭증 + 매도압력

### 정보 테이블
- 추세, HTF, ADX
- RSI, StochK, MACD
- 거래량, 매수압력
- BB 위치, 점수, 시그널

---

## 권장 사용법

### 시그널 확인용 (V35-Signal)
1. TradingView에서 V35-Signal 적용
2. MTF LONG 시그널 (큰 라임 화살표) 대기
3. 정보 테이블에서 확인:
   - HTF: LONG 또는 상승
   - 추세: UP
   - RSI: 45~65
   - StochK: 20~40 (과매도 탈출)
   - 거래량: 1.5x 이상
4. 수동으로 진입 판단

### 백테스트용 (V35-Strategy)
1. V35-Strategy 적용
2. 설정:
   - MTF 시그널만 거래: ON
   - LONG만 거래: ON
   - TP: 1.0%, SL: 0.5%
3. 전략 테스터에서 결과 확인

---

## 텔레그램 연동 정보

### 채널 정보
- 무료 채널: https://t.me/V30_Trading
- 유료 채널: V30 Premium (비공개)
- 토론 그룹 ID: -1003318469200

### Pipedream
- 시그널 웹훅: https://eoybgq22a09g1el.m.pipedream.net
- 봇 명령어: /start, /free, /price, /contact

---

## 다음 단계 (TODO)

- [ ] V35 실전 테스트 (1주일)
- [ ] 15분봉/1시간봉에서 테스트
- [ ] 승률 50%+ 달성 시 알림 자동화
- [ ] TradingView 마켓 등록 검토

---

## 백테스트 결과 요약

| 버전 | 거래수 | 승률 | 손익비 | 비고 |
|------|--------|------|--------|------|
| V32 | 5,812 | 20% | ? | 과다 거래 |
| V33 | 192 | 35% | 0.21 | TP < SL |
| V34 | 124 | 13% | 0.16 | 더 나빠짐 |
| V35 | 56 | 23% (L:31%) | 0.98 | MTF 적용 |

**결론**: LONG만 + MTF 시그널만 거래 시 LONG 승률 31% 달성
